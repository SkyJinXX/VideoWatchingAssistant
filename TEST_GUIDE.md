# 🧪 YouTube语音助手测试指南

## 🎯 测试目标

在不加载Chrome扩展的情况下，快速测试各个功能模块，发现并修复问题。

## 🚀 快速开始

### 方法1: 直接打开测试文件（推荐新手）
```bash
# 直接双击或用浏览器打开
test.html
```
**优点**: 简单快速  
**缺点**: 字幕API受CORS限制，使用模拟数据

### 方法2: 启动本地服务器（推荐开发者）
```bash
# Windows用户
start-test-server.bat

# macOS/Linux用户  
python start-test-server.py

# 或使用Python内置服务器
python -m http.server 8080
```
**优点**: 更接近真实环境  
**缺点**: 字幕API仍可能有CORS限制

### 方法3: 使用VS Code Live Server
1. 安装VS Code Live Server扩展
2. 右键`test.html` → "Open with Live Server"

## 📋 测试流程

### 1. 配置测试环境
- **API密钥**: 输入有效的OpenAI API密钥
- **视频ID**: 使用默认的`dQw4w9WgXcQ`（Rick Roll）或自定义

### 2. 按顺序测试模块

#### 🔧 基础组件测试
```
✅ CryptoJS库 - 测试加密解密功能
✅ 字幕提取器 - 测试SRT解析功能  
✅ OpenAI客户端 - 测试客户端创建
```

#### 📋 字幕功能测试
```
🟡 字幕API - 使用模拟数据（CORS限制）
🟡 字幕下载 - 使用示例内容
✅ 字幕解析 - 测试SRT解析
✅ 时间戳搜索 - 测试上下文提取
```

#### 🤖 OpenAI API测试
```
✅ API连接 - 测试密钥和网络连接
✅ 文本转语音 - 测试TTS功能和播放
✅ GPT对话 - 测试对话生成
```

#### 🎤 音频功能测试
```
✅ 麦克风权限 - 测试权限获取
✅ 录音功能 - 测试3秒录音
✅ 音频播放 - 测试音频播放
```

#### 🔄 完整流程测试
```
✅ 端到端流程 - 模拟完整对话流程
✅ 错误处理 - 测试各种错误情况
```

## 🐛 常见问题与解决方案

### CORS错误
```
错误: Access to fetch at 'https://get-info.downsub.com/...' has been blocked by CORS policy
解决: 使用模拟数据测试代码逻辑，真实API在Chrome扩展环境测试
```

### API密钥错误
```
错误: API连接失败
解决: 
1. 检查密钥格式 (sk-...)
2. 确认密钥有效且有余额
3. 检查网络连接
```

### 麦克风权限被拒
```
错误: 麦克风权限获取失败
解决:
1. 点击地址栏左侧锁定图标
2. 设置麦克风权限为"允许"
3. 刷新页面重试
```

### 音频播放失败
```
错误: 音频播放失败
解决:
1. 检查浏览器音量设置
2. 确认没有其他音频在播放
3. 尝试其他浏览器
```

## 📊 测试结果分析

### 成功指标
- ✅ 所有基础组件正常加载
- ✅ OpenAI API连接成功
- ✅ 音频录制和播放正常
- ✅ 字幕解析功能正常
- ✅ 完整流程模拟成功

### 预期限制
- 🟡 字幕API使用模拟数据（CORS限制）
- 🟡 无法测试真实YouTube页面注入
- 🟡 无法测试Chrome扩展特有功能

## 🔧 调试技巧

### 1. 使用浏览器开发者工具
```bash
F12 → Console → 查看错误信息
F12 → Network → 检查API请求
F12 → Application → 检查存储数据
```

### 2. 导出测试结果
- 点击"导出测试结果"保存JSON格式的测试数据
- 可用于错误分析和bug报告

### 3. 逐步测试
- 不要一次运行所有测试
- 先测试基础组件，再测试复杂功能
- 遇到错误立即停止，分析原因

## 🚀 从测试到扩展

### 测试通过后的步骤
1. **创建扩展图标** - 参考`icons/README.md`
2. **加载Chrome扩展** - 参考`INSTALL.md`
3. **真实环境测试** - 在YouTube页面测试
4. **问题反馈** - 在GitHub Issues报告问题

### 测试环境 vs 扩展环境对比

| 功能 | 测试环境 | 扩展环境 |
|------|----------|----------|
| 基础组件 | ✅ 完全支持 | ✅ 完全支持 |
| OpenAI API | ✅ 完全支持 | ✅ 完全支持 |
| 音频功能 | ✅ 完全支持 | ✅ 完全支持 |
| 字幕API | 🟡 模拟数据 | ✅ 真实数据 |
| YouTube集成 | ❌ 无法测试 | ✅ 完全支持 |
| Chrome存储 | ❌ 无法测试 | ✅ 完全支持 |

## 💡 测试建议

1. **重点测试OpenAI功能** - 这是最容易出问题的部分
2. **验证音频权限** - 确保录音和播放正常
3. **测试错误处理** - 故意输入错误参数看错误提示
4. **性能测试** - 观察API调用速度和响应时间
5. **兼容性测试** - 在不同浏览器中测试

## 📞 获取帮助

- 📚 查看项目文档: `README.md`
- 🐛 报告问题: GitHub Issues
- 💬 讨论交流: GitHub Discussions

---

🎉 **祝测试顺利！发现问题及时反馈，让我们一起完善这个项目！** 